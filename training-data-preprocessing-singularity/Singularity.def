Bootstrap: docker
From: rust:1.74-slim

%files
    . /opt/training-data-preprocessing

%post
    # 安装必要依赖（如 pkg-config 和 libssl-dev）
    apt-get update && apt-get install -y pkg-config libssl-dev && rm -rf /var/lib/apt/lists/*
    # 进入项目目录
    cd /opt/training-data-preprocessing
    # 编译 Rust 项目（release 版本）
    cargo build --release
    # 将编译好的二进制复制到系统目录
    mkdir -p /usr/local/bin
    cp target/release/training-data-preprocessing /usr/local/bin/

%environment
    # 将 /usr/local/bin 加入 PATH
    export PATH=/usr/local/bin:$PATH

%runscript
    # 当容器运行时，默认执行编译后的程序，并传递所有命令行参数
    exec /usr/local/bin/training-data-preprocessing "$@"
